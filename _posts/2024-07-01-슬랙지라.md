---
title: Jira Slack APIë¥¼ ì´ìš©í•˜ì—¬ Daily Report ë§Œë“¤ê¸°
categories: [í† ì´í”„ë¡œì íŠ¸]
tags: [JIRA, SLACK]
---

íšŒì‚¬ì—ì„œ ë§¤ì¼ ì—…ë¬´ ì‹œì‘ê³¼ ì¢…ë£Œ ì‹œì— ë°ì¼ë¦¬ ë¦¬í¬íŠ¸ë¥¼ ì‘ì„±í•œë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ ì´ë ‡ê²Œ ì‘ì„± í•œë‹¤.

ì—…ë¬´ ì‹œì‘

------
ğŸ’¡ 0000.00.00 (ì›”) ê¸ˆì¼ ì—…ë¬´ ìˆ˜í–‰í•  ê³„íš [ê·¼ë¬´ì§€: xxxì˜¤í”¼ìŠ¤]

[Jira í‹°ì¼“] [BE] í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„± estimated 1h / left 1h

---


ì—…ë¬´ ì¢…ë£Œ 
---

ğŸ’¡ 0000.00.00 (ì›”) ê¸ˆì¼ ì—…ë¬´ ìˆ˜í–‰í•œ ë‚´ìš© [ê·¼ë¬´ì§€: xxxì˜¤í”¼ìŠ¤]

[Jira í‹°ì¼“] [BE] í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„± estimated 1h / left 1h / progress 1h --> left 0h [done]

---

ì—…ë¬´ì˜ ì‹œì‘ê³¼ ì¢…ë£Œì— ì–´ë–¤ ì—…ë¬´ë¥¼ í•´ì•¼ í•˜ê³  ì–¼ë§ˆë‚˜ ì§„í–‰í–ˆëŠ”ì§€ íŒŒì•…í•˜ê¸°ëŠ” ì¢‹ì§€ë§Œ, ë¶ˆí¸í•œ ì ì´ ëª‡ ê°€ì§€ê°€ ìˆì—ˆë‹¤.

1. ë‚ ì§œ, ìš”ì¼, Jira í‹°ì¼“ ë„˜ë²„ ë“± ì˜¤íƒ€ ë°œìƒ
- ì•„ë¬´ë˜ë„ ìˆ˜ê¸°ë¡œ ì‘ì„±í•˜ë‹¤ ë³´ë‹ˆ ì˜ëª»ëœ ë‚ ì§œë‚˜ ìš”ì¼ë¡œ ì‘ì„±í•˜ê±°ë‚˜ Jira í‹°ì¼“ ë„˜ë²„ê°€ ë§ì§€ ì•ŠëŠ” ì˜¤ë¥˜ê°€ ìˆì–´ì„œ ë‚˜ì¤‘ì— ë°œê²¬í•˜ê³  ìˆ˜ì •í•˜ëŠ” ê²½ìš°ê°€ ì¢…ì¢… ìˆì—ˆë‹¤.
1. ë°ì¼ë¦¬ ë¦¬í¬íŠ¸ ì‘ì„± ìì²´ë¥¼ ìŠì–´ë²„ë¦¬ëŠ” ê²½ìš°ê°€ ë°œìƒ
- ë³´í†µì˜ ê²½ìš°ë¼ë©´ ê¹Œë¨¹ì§€ ì•Šì§€ë§Œ, ì•„ì¹¨ì— ì¶œê·¼í•˜ìë§ˆì ì´ìŠˆê°€ ìƒê²¨ì„œ íšŒì˜ë¥¼ í•˜ê±°ë‚˜, ë²„ê·¸ ë°œìƒìœ¼ë¡œ ì •ì‹  ì—†ëŠ” ìƒíƒœë¼ë©´ ìŠì–´ë²„ë¦¬ëŠ” ê²½ìš°ê°€ ìƒê²¼ë‹¤.
1. Jiraì— ìˆëŠ” ì •ë³´ë¥¼ ì‘ì„±í•  í•„ìš”ê°€ ìˆì„ê¹Œ?
- ë°ì¼ë¦¬ ë¦¬í¬íŠ¸ëŠ” ë§í•˜ìë§Œ ì§ì ‘ ì‘ì„±í•˜ëŠ” Jira í‹°ì¼“ì´ë‹¤. Jiraì— ë˜‘ê°™ì€ ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë° êµ³ì´ Slack ì±„ë„ì— ë©”ì‹œì§€ë¥¼ ì‘ì„±í•´ì•¼ í•˜ëŠ”ì§€ì™€ ê°™ì€ í•„ìš”ì„±ì— ì˜ë¬¸ì´ ë“¤ì—ˆë‹¤.

ì´ëŸ¬í•œ ë¬¸ì œì ë“¤ì´ ìˆì–´ì„œ ë°ì¼ë¦¬ ë¦¬í¬íŠ¸ë¥¼ ìë™í™”í•´ì£¼ëŠ” ì„œë²„ë¥¼ ë§Œë“¤ì–´ íš¨ìœ¨ì„ ë†’ì´ë ¤ ì‹œë„í–ˆë‹¤. 

ë¨¼ì € êµ¬í˜„ íë¦„ì€ ì´ë ‡ê²Œ ì¡ì•˜ë‹¤.

1. Jira APIë¥¼ ì´ìš©í•´ì„œ ì›í•˜ëŠ” ì´ìŠˆ ì •ë³´ ë¶ˆëŸ¬ì˜¨ë‹¤.
    1. ë°ì¼ë¦¬ ë¦¬í¬íŠ¸ì— [ì§„í–‰ ì¤‘]ì¸ ì´ìŠˆì™€ ì˜¤ëŠ˜ ì™„ë£Œí•œ [ì™„ë£Œë¨]ì˜ ì´ìŠˆì˜ ì •ë³´ê°€ í•„ìš”í•¨
2. ë¶ˆëŸ¬ì˜¨ ì´ìŠˆë¥¼ ì„œë²„ì—ì„œ ê°€ê³µ
    1. íšŒì‚¬ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°ì¼ë¦¬ ë¦¬í¬íŠ¸ ì–‘ì‹ì´ ìˆì—ˆê¸° ë•Œë¬¸ì— í•´ë‹¹ ì–‘ì‹ìœ¼ë¡œ ì¶œë ¥í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ê°€ê³µí•˜ëŠ” ì‘ì—…ì´ í•„ìš”í•˜ë‹¤.
    2. ì´ìŠˆì˜ ì¶”ì • ì‹œê°„, ì†Œìš” ì‹œê°„ ë“±ì€ ê°€ì ¸ì˜¬ ìˆ˜ ìˆì§€ë§Œ ì§„í–‰í•œ ì‹œê°„ì€ ê³„ì‚°ì„ í•´ì•¼ í–ˆê¸° ë•Œë¬¸ì— í•´ë‹¹ ë¡œì§ë„ í•„ìš”í•˜ë‹¤.
3. í‰ì¼ (ì›” ~ ê¸ˆ) ì—…ë¬´ ì‹œì‘ ì‹œê°„ì¸ ì˜¤ì „ 09ì‹œì™€ ì—…ë¬´ ì¢…ë£Œ ì‹œê°„ì¸ ì˜¤í›„ 06ì‹œì— @Schedulerë¥¼ ì‚¬ìš©í•˜ì—¬ ìë™ìœ¼ë¡œ Slackìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ ë³´ë‚¸ë‹¤. 

### 1. í”„ë¡œì íŠ¸ ìƒì„±

```groovy
// build.gradle


dependencies {
	implementation 'org.springframework.boot:spring-boot-starter-batch'
	implementation 'org.springframework.boot:spring-boot-starter-web'
	implementation 'org.springframework.cloud:spring-cloud-starter-openfeign'
	testImplementation 'org.springframework.boot:spring-boot-starter-test'
	testImplementation 'org.springframework.batch:spring-batch-test'
	testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
	implementation("com.slack.api:bolt:1.18.0")
	implementation("com.slack.api:bolt-servlet:1.18.0")
	implementation("com.slack.api:bolt-jetty:1.18.0")
	compileOnly 'org.projectlombok:lombok'
	annotationProcessor 'org.projectlombok:lombok'
}

```

- Jira API ì—°ë™ì„ ìœ„í•´ openfeign ì˜ì¡´ì„±ì„ ì¶”ê°€í•´ì£¼ê³  scheduler batch jobì„ ìœ„í•´ spring batchë¥¼ ì¶”ê°€í•´ì¤€ë‹¤.
- Slack Messageë¥¼ ì´ìš©í•˜ê¸° ìœ„í•´ Slack ì˜ì¡´ì„±ë„ ì¶”ê°€í•´ì¤€ë‹¤.

### 2. Jiraì—ì„œ ì´ìŠˆ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê¸°

- ë¨¼ì € @EnableScheduling, @EnableFeignClients ë¥¼ ì¶”ê°€í•´ì„œ schedulerì™€ feign clientë¥¼ í™œì„±í™” í•´ì¤€ë‹¤.
    
    ```java
    @SpringBootApplication
    @EnableScheduling // ì¶”ê°€ 
    @EnableFeignClients // ì¶”ê°€ 
    public class DailyreportApplication {
    
    	public static void main(String[] args) {
    		SpringApplication.run(DailyreportApplication.class, args);
    	}
    
    }
    ```
    
- Feign clientë¥¼ ì´ìš©í•˜ì—¬ Jira apiì— issue ì •ë³´ë¥¼ ìš”ì²­í•œë‹¤.
    
    ```java
    @FeignClient(name = "jiraClient", url = JIRA_URL)
    public interface JiraClient {
        @GetMapping
        String loadJiraIssue(@RequestParam String jql,
    											   @RequestHeader("Authorization") String token);
    }
    ```
    
    - ì—¬ê¸°ì„œ jqlì€ JiraÂ Query Languageì´ë‹¤.  Jira Issue ë¥¼ ê²€ìƒ‰í•˜ê¸° ìœ„í•œ êµ¬ì¡°ì ì¸ ì–¸ì–´ì´ë‹¤.
- Jira APIì—ì„œ ë°›ì•„ì˜¨ ì •ë³´ë¥¼ ê°€ê³µí•˜ì—¬ Slackìœ¼ë¡œ ì „ì†¡í•œë‹¤.
    - Slackì—ì„œëŠ” ë©”ì‹œì§€ë¥¼ Block Templateë¥¼ ì´ìš©í•˜ì—¬ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.
        
        [](https://app.slack.com/block-kit-builder)
        
    - Slack APIë¥¼ ì´ìš©í•˜ì—¬ Blocksë¥¼ ì´ìš©í•˜ì—¬ ì›í•˜ëŠ” í…œí”Œë¦¿ì„ ë§Œë“¤ê³  chatPostMessageë¥¼ ì´ìš©í•˜ì—¬ ë©”ì‹œì§€ë¥¼ ë³´ë‚¸ë‹¤.
    
    ```java
    public void generateBlocks() {
        List<LayoutBlock> blocks = new ArrayList<>();
        blocks.add(section(section -> section.text(markdownText(helloChat()))));
        blocks.add(divider());
        blocks.add(section(section -> section.text(markdownText(title()))));
        blocks.add(section(section -> section.text(markdownText(makeEndMessage(issueDto)))));
        blocks.add(divider());
        blocks.add(section(section -> section.text(markdownText(endChat()))));
    }
    
    ..
    
    
    public void sendMessage(List<LayoutBlock> blocks) {
        MethodsClient methods = Slack.getInstance().methods(SLACK_TOKEN);
        ChatPostMessageRequest request = ChatPostMessageRequest.builder()
                .channel(SLACK_CHANNEL)
                .blocks(blocks)
                .build();
        methods.chatPostMessage(request);
    }
    
    ..
    
    private String helloChat(){
        StringBuilder sb = new StringBuilder();
        return sb.append("ì•ˆë…•í•˜ì„¸ìš” :wave: Daily Report Botì…ë‹ˆë‹¤. \n \n ì˜¤ëŠ˜ ì§„í–‰í•  ì—…ë¬´ ë‚´ìš© ê³µìœ ë“œë¦½ë‹ˆë‹¤. \n").toString();
    }
    private String title(){
        DayOfWeek ìš”ì¼ = LocalDateTime.now().getDayOfWeek();
        StringBuilder sb = new StringBuilder();
        String ë‚ ì§œ = LocalDateTime.now().format(DateTimeFormatter.ofPattern("yyyy.MM.dd"));
        return sb.append(":date: *[").append(ë‚ ì§œ).append(" (").append(ìš”ì¼).append(") ì—…ë¬´ ì§„í–‰í•  ê³„íš - ê·¼ë¬´ : 00ì˜¤í”¼ìŠ¤]*")
                .append("\n").toString();
    }
    
    private String endChat(){
        StringBuilder sb = new StringBuilder();
        return sb.append("ì˜¤ëŠ˜ë„ ì¢‹ì€ í•˜ë£¨ ë³´ë‚´ì„¸ìš” :slightly_smiling_face:").toString();
    }
    ```
    

### 3. ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¼ì •í•œ ì‹œê°„ì— Slack Message ì „ì†¡

```java
@Scheduled(cron = "0 0 9 * * 1-5", zone = "Asia/Seoul") // ë§¤ì¼ ì˜¤ì „ 9ì‹œ ì‹¤í–‰
public void runDailyReport() {
    sendSlackMessage.sendMessage();	
}
```

### ê²°ê³¼

ì„±ê³µì ìœ¼ë¡œ ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ëŠ” ëª¨ìŠµì„ ë³´ì¸ë‹¤.

![ìŠ¬ë™ì§€ë¼1](/assets/img/docimg/ìŠ¬ë™ì§€ë¼1.png)